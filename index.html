<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title> SWAN: Stuff We All Need (Unosquare's collection of C# extension methods and classes) | Unosquare SWAN </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content=" SWAN: Stuff We All Need (Unosquare's collection of C# extension methods and classes) | Unosquare SWAN ">
    <meta name="generator" content="docfx 2.40.8.0">
    
    <link rel="shortcut icon" href="favicon.ico">
    <link rel="stylesheet" href="styles/docfx.vendor.css">
    <link rel="stylesheet" href="styles/docfx.css">
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/bootstrap.min.css">
    <meta property="docfx:navrel" content="toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="">
    
  </head>
  <body data-spy="scroll" data-target="#affix">
    <div id="wrapper">
      <header>
        
        <nav class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="index.html">
                <img id="logo" class="logo" src="best-practices/resources/images/unosquare_logo.svg" alt="Unosquare">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items"></div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">

<p><a href="https://www.nuget.org/packages/Unosquare.Swan"><img src="https://img.shields.io/nuget/dt/Unosquare.Swan.svg" alt="NuGet"></a>
<a href="https://travis-ci.org/unosquare/swan"><img src="https://travis-ci.org/unosquare/swan.svg?branch=master" alt="Build Status"></a>
<a href="https://ci.appveyor.com/project/geoperez/swan/branch/master"><img src="https://ci.appveyor.com/api/projects/status/063tybvog8mb1sic/branch/master?svg=true" alt="Build status"></a>
<a href="https://coveralls.io/github/unosquare/swan?branch=master"><img src="https://coveralls.io/repos/github/unosquare/swan/badge.svg?branch=master" alt="Coverage Status"></a>
<a href="https://www.codacy.com/project/UnosquareLabs/swan/dashboard?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=unosquare/swan&amp;utm_campaign=Badge_Grade_Dashboard"><img src="https://api.codacy.com/project/badge/Grade/c588287f33694935a4d061e82baf62f5" alt="Codacy Badge"></a></p>
<h1 id="img-srchttpsgithubcomunosquareswanrawmasterswan-logo-32pngimg-swan-stuff-we-all-need-unosquares-collection-of-c-extension-methods-and-classes"><img src="https://github.com/unosquare/swan/raw/master/swan-logo-32.png"> SWAN: Stuff We All Need (Unosquare&#39;s collection of C# extension methods and classes)</h1>
<p><em><span class="emoji" shortcode="star">⭐</span> Please star this project if you find it useful!</em></p>
<p>SWAN stands for Stuff We All Need</p>
<p>Repeating code and reinventing the wheel is generally considered bad practice. At <a href="https://www.unosquare.com">Unosquare</a> we are committed to beautiful code and great software. Swan is a collection of classes and extension methods that we (and other good developers) have written and evolved over the years. We found ourselves copying and pasting the same code for every project every time we started them. We decided to kill that cycle once and for all. This is the result of that idea. Our philosophy is that Swan should have no external dependencies, it should be cross-platform, and it should be useful.</p>
<h1 id="table-of-contents">Table of contents</h1>
<ul>
<li><a href="#-libraries">📚 Libraries</a></li>
<li><a href="#-installation">💾Installation</a></li>
<li><a href="#whats-in-the-library">What&#39;s in the library</a><ul>
<li><a href="#the-runtime-component">The Runtime component</a></li>
<li><a href="#the-terminal-class">The Terminal class</a></li>
<li><a href="#the-json-formatter">The Json formatter</a></li>
<li><a href="#the-csvwriter-class">The CsvWriter class</a></li>
<li><a href="#the-csvreader-class">The CsvReader class</a></li>
<li><a href="#the-jsonclient-class">The JsonClient class</a></li>
<li><a href="#the-smtpclient-class">The SmtpClient class</a></li>
<li><a href="#the-objectmapper-component">The ObjectMapper component</a></li>
<li><a href="#the-network-component">The Network component</a></li>
<li><a href="#the-objectcomparer-component">The ObjectComparer component</a></li>
<li><a href="#the-objectvalidator-component">The ObjectValidator component</a></li>
<li><a href="#the-dependencycontainer-component">The DependencyContainer component</a></li>
<li><a href="#the-messagehub-component">The MessageHub component</a></li>
<li><a href="#the-ldapconnection-class">The LdapConnection class</a></li>
<li><a href="#the-processrunner-class">The ProcessRunner class</a></li>
<li><a href="#the-appworkerbase-class">The AppWorkerBase class</a></li>
<li><a href="#the-argumentparser-component">The ArgumentParser component</a></li>
<li><a href="#the-settingsprovider-abstraction">The SettingsProvider abstraction</a></li>
<li><a href="#the-connection-class">The Connection class</a></li>
<li><a href="#the-benchmark-component">The Benchmark component</a></li>
<li><a href="#the-delayprovider-component">The DelayProvider component</a></li>
<li><a href="#the-waiteventfactory-component">The WaitEventFactory component</a></li>
<li><a href="#atomic-types">Atomic Types</a></li>
</ul>
</li>
</ul>
<h2 id="-libraries">📚 Libraries</h2>
<p>We offer the Swan library in two flavors since version 0.24. Swan Lite provides basic classes and extension methods and Swan Standard (we call it Fat Swan) provides everything in Swan Lite plus Network, WinServices, DI and more. See the following table to understand the components available to these flavors of Swan.</p>
<table>
<thead>
<tr>
<th>Component</th>
<th>Swan Lite</th>
<th>Swan Standard</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Abstractions.AppWorkerBase.html">AppWorkerBase</a></td>
<td><span class="emoji" shortcode="x">❌</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Components.ArgumentParser.html">ArgumentParser</a></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.ByteArrayExtensions.html">ByteArrayExtensions</a></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Components.CircularBuffer.html">CircularBuffer</a></td>
<td><span class="emoji" shortcode="x">❌</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Networking.Connection.html">Connection</a></td>
<td><span class="emoji" shortcode="x">❌</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Networking.ConnectionListener.html">ConnectionListener</a></td>
<td><span class="emoji" shortcode="x">❌</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Components.CsProjFile-1.html">CsProjFile<t></t></a></td>
<td><span class="emoji" shortcode="x">❌</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Formatters.CsvReader.html">CsvReader</a></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Formatters.CsvWriter.html">CsvWriter</a></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.DateExtensions.html">DateExtensions</a></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.DateTimeSpan.html">DateTimeSpan</a></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Definitions.html">Definitions</a></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Components.DependencyContainer.html">DependencyContainer</a></td>
<td><span class="emoji" shortcode="x">❌</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Components.EnumHelper.html">EnumHelper</a></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Extensions.html">Extensions</a></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.FunctionalExtensions.html">FunctionalExtensions</a></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Formatters.Json.html">Json</a></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Networking.JsonClient.html">JsonClient</a></td>
<td><span class="emoji" shortcode="x">❌</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Networking.Ldap.LdapConnection.html">LdapConnection</a></td>
<td><span class="emoji" shortcode="x">❌</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Components.MessageHub.html">MessageHub</a></td>
<td><span class="emoji" shortcode="x">❌</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Network.html">Network</a></td>
<td><span class="emoji" shortcode="x">❌</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.NetworkExtensions.html">NetworkExtensions</a></td>
<td><span class="emoji" shortcode="x">❌</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Components.ObjectComparer.html">ObjectComparer</a></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Components.ObjectMapper.html">ObjectMapper</a></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Components.ObjectValidator.html">ObjectValidator</a></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Components.ProcessRunner.html">ProcessRunner</a></td>
<td><span class="emoji" shortcode="x">❌</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.ReflectionExtensions.html">ReflectionExtensions</a></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Runtime.html">Runtime</a></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Abstractions.SettingsProvider-1.html">SettingsProvider<t></t></a></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Abstractions.SingletonBase-1.html">SingletonBase<t></t></a></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Networking.SmtpClient.html">SmtpClient</a></td>
<td><span class="emoji" shortcode="x">❌</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Networking.SnmpClient.html">SnmpClient</a></td>
<td><span class="emoji" shortcode="x">❌</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.StringExtensions.html">StringExtensions</a></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Terminal.html">Terminal</a></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Reflection.TypeCache-1.html">TypeCache<t></t></a></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
<tr>
<td><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.ValueTypeExtensions.html">ValueTypeExtensions</a></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
<td><span class="emoji" shortcode="heavy_check_mark">✔️</span></td>
</tr>
</tbody>
</table>
<p>If you are developing an ASP.NET Core application, we recommend to use <a href="https://github.com/unosquare/swan-aspnetcore">SWAN AspNet.Core</a>.</p>
<h2 id="-installation">💾 Installation:</h2>
<p>Swan Standard Installation:</p>
<p><a href="https://badge.fury.io/nu/Unosquare.Swan"><img src="https://badge.fury.io/nu/Unosquare.Swan.svg" alt="NuGet version"></a></p>
<pre><code>PM&gt; Install-Package Unosquare.Swan
</code></pre><p>Swan Lite Installation:</p>
<p><a href="https://badge.fury.io/nu/Unosquare.Swan.Lite"><img src="https://badge.fury.io/nu/Unosquare.Swan.Lite.svg" alt="NuGet version"></a></p>
<pre><code>PM&gt; Install-Package Unosquare.Swan.Lite
</code></pre><h2 id="whats-in-the-library">What&#39;s in the library</h2>
<p>In this section, we present the different components that are available in the Swan library. Please keep in mind that everything in the library is opt-in. Swan is completely opt-in. It won&#39;t force you to use any of its components, classes or methods.</p>
<h3 id="the-runtime-component">The <code>Runtime</code> component</h3>
<p><code>Runtime</code> provides properties and methods that provide information about the application environment (including Assemblies and OS) and access to singleton instance of other components inside Swan such as <code>ObjectMapper</code>.</p>
<p><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Runtime.html">Runtime API Doc</a></p>
<h3 id="the-terminal-class">The <code>Terminal</code> class</h3>
<p>Many times, we find ourselves implementing <code>Console</code> output code as some <code>NLog</code> or <code>Log4Net</code> logger or adapter, especially when writing console applications, daemons, and Windows services or Linux daemons. We also tend to write <code>Console</code> code for reading user input because it can&#39;t be some logger or adapter. And then you have the <code>System.Diagnostics.Debug</code> class to write to the debugger output. And finally, all your <code>Console</code> user interaction looks primitive and unprofessional. In other 
words, you end up with 3 things you are unsure of how to put together in the different configurations and runtime environments:
<code>Console</code>, <code>Debug</code> and some logging mechanism. In return you have placed unintended logging code, <code>Console</code> code, and <code>Debug</code> 
code everywhere in your application and it makes it look silly, bloated and written by an amateur.  </p>
<p>The Swan <code>Terminal</code> is <strong>all</strong> of the following:</p>
<ul>
<li>Console Standard Output Writer</li>
<li>Console Standard Error Writer </li>
<li>Debug Writer</li>
<li>Console Standard Input Reader</li>
<li>Log message forwarder</li>
</ul>
<p>It is also very easy to use, it&#39;s thread-safe, and it does not require you to learn anything new. In fact, it simplifies logging
messages and displaying <code>Console</code> messages by providing <code>string</code> extension methods.</p>
<p><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Terminal.html">Terminal API Doc</a></p>
<h4 id="example-1-writing-to-the-terminal">Example 1: Writing to the Terminal</h4>
<p>This only writes messages out to the <code>TerminalWriters</code> if there are any available. In practice, we typically <strong>DO NOT</strong> use
the <code>Write</code> and <code>WriteLine</code> methods but they are provided for convenience, extensibility and customization. Please note
that these methods do not forward messages as logging events and therefore whatever is written via these methods
will not show up in you logging subsystem.</p>
<pre><code class="lang-csharp">// The simplest way of writing a line of text -- equivalent to `Console.WriteLine`:
Terminal.WriteLine($&quot;Hello, today is {DateTime.Today}&quot;);

// A slightly better way using extension methods:
$&quot;Hello, today is {DateTime.Today}&quot;.WriteLine();

// Now, let&#39;s add some color:
$&quot;Hello, today is {DateTime.Today}&quot;.WriteLine(ConsoleColor.Green);

// Write it out to the debugger as well!
$&quot;Hello, today is {DateTime.Today}&quot;.WriteLine(ConsoleColor.Green, TerminalWriters.StandardOutput | TerminalWriters.Diagnostics);

// You could have also set the color argument to null and just use the configured default
$&quot;Hello, today is {DateTime.Today}&quot;.WriteLine(null, TerminalWriters.StandardOutput | TerminalWriters.Diagnostics);
</code></pre><h4 id="example-2-basic-logging">Example 2: Basic Logging</h4>
<p>This is where <code>Terminal</code> really shines. Instead of using the <code>Write</code> and <code>WriteLine</code> methods, you can use the methods that are intended for logging. These methods have different purposes and distinct functionality. Please
refer to the example below and its comments.</p>
<pre><code class="lang-csharp">$&quot;Hello, today is {DateTime.Today}&quot;.Info();
$&quot;Hello, today is {DateTime.Today}&quot;.Debug();
$&quot;Hello, today is {DateTime.Today}&quot;.Warn();
$&quot;Hello, today is {DateTime.Today}&quot;.Error();
$&quot;Hello, today is {DateTime.Today}&quot;.Trace();
</code></pre><h4 id="example-3-forwarding-logging-messages">Example 3: Forwarding Logging Messages</h4>
<p>Suppose you have various calls to <code>Terminal</code>&#39;s logging methods such as <code>Info()</code>, <code>Warn()</code>, <code>Error()</code>, <code>Trace()</code>
and <code>Debug()</code>. You wish to forward those messages to a logging subsystem in addition to using the <code>Console</code>&#39;s
standard output and standard error, and the built-in diagnostics output. All you have to do is subscribe to the
Terminal&#39;s <code>OnLogMessageReceived</code> event. The event arguments of this event provide useful properties that you
can piece together to send your logging messages directly to the Logging subsystem in your application.</p>
<h4 id="example-4-configuring-output">Example 4: Configuring Output</h4>
<p>Swan&#39;s <code>Terminal</code> provides both, flexibility and consistency for all of its output. While it will pick the most
common defaults for a given build or runtime scenario, you are able to modify such defaults and adjust them to your
liking. You can change the output colors,  </p>
<h4 id="example-5-user-interaction">Example 5: User Interaction</h4>
<p>The Swan <code>Terminal</code> would not be complete without a way to read user input. The good news is
that <code>Terminal</code> can create decent-looking user prompts if a very convenient way.</p>
<pre><code class="lang-csharp">// Reads a line of text from the console.
var lineResult = Terminal.ReadLine();

// Reads a number from the input. If unable to parse, it returns the default number, in this case (default 0).
var numberResult = Terminal.ReadNumber(&quot;Read Number&quot;, 0);

// Creates a table prompt where the user can enter an option based on the options dictionary provided.
var promptResult = Terminal.ReadPrompt(&quot;Read Promp&quot;, options, &quot;A&quot;);

// Reads a key from the terminal preventing the key from being echoed.
var keyResult = Terminal.ReadKey(&quot;Read Key&quot;);
</code></pre><h4 id="example-6-other-useful-functions">Example 6: Other Useful Functions</h4>
<p>Swan&#39;s <code>Terminal</code> also provides additional methods to accomplish very specific tasks. Given the fact that <code>Terminal</code>
is an asynchronous, thread-safe output queue, we might under certain situations require all of the output queues to be written
out to the <code>Console</code> before the program exits. For example, when we write a console application that requires its usage
to be fully printed out before the process is terminated. In these scenarios, we use <code>Terminal.Flush</code> which blocks
the current thread until the entire output queue becomes empty.</p>
<h3 id="the-json-formatter">The <code>Json</code> Formatter</h3>
<p>You can serialize and deserialize strings and objects using Swan&#39;s <code>Json</code> Formatter. It&#39;s a great way to transform objects to JSON format and vice versa. For example, you need to send information as JSON format to another point of your application and when arrives it&#39;s necessary to get back to the object that is going to be used, and thanks to JSON format the data can interchange in a lightweight way.</p>
<p><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Formatters.Json.html">Json API Doc</a></p>
<h4 id="example-1-serialize">Example 1: Serialize</h4>
<p>Serializes the specified object into a JSON <code>string</code>.</p>
<pre><code class="lang-csharp">// The object to be serialize
var basicObject = new { One = &quot;One&quot;, Two = &quot;Two&quot;, Three = &quot;Three&quot; };
// Serializes the specified object into a JSON string.
var data = Json.Serialize(basicObject);
</code></pre><h4 id="example-2-serialize-included-properties">Example 2: Serialize included properties</h4>
<p>Serializes the specified object only including the specified property names.</p>
<pre><code class="lang-csharp">// The object to be serialize
var basicObject = new { One = &quot;One&quot;, Two = &quot;Two&quot;, Three = &quot;Three&quot; };
// The included names
var includedNames  = new[] { &quot;Two&quot;, &quot;Three&quot; };
// Serialization Only.
var data = Json.SerializeOnly(basicObject, true, includedNames);
</code></pre><h4 id="example-3-serialize-excluding-properties">Example 3: Serialize excluding properties</h4>
<p>Serializes the specified object excluding the specified property names.</p>
<pre><code class="lang-csharp">// The object to be serialize
var basicObject = new { One = &quot;One&quot;, Two = &quot;Two&quot;, Three = &quot;Three&quot; };
// The excluded names
var excludeNames  = new[] { &quot;Two&quot;, &quot;Three&quot; };
// Serialization Excluding
var data = Json.SerializeExcluding(basicObject, true, excludeNames);
</code></pre><h4 id="example-4-serialize-an-object-using-attributes">Example 4: Serialize an object using attributes</h4>
<p>Serializes the specified object whose properties have a <code>JsonPropertyAttribute</code></p>
<pre><code class="lang-csharp"> class JsonPropertyExample
{
   [JsonProperty(&quot;data&quot;)]
   public string Data { get; set; }

   [JsonProperty(&quot;ignoredData&quot;, true)]
   public string IgnoredData { get; set; }
}
</code></pre><pre><code class="lang-csharp"> var obj = new JsonPropertyExample() { Data = &quot;OK&quot;, IgnoredData = &quot;OK&quot; };

 // {&quot;data&quot;: &quot;OK&quot;}
 var serializedObj = Json.Serialize(obj);
</code></pre><h4 id="example-5-deserialize">Example 5: Deserialize</h4>
<p>Deserializes the specified JSON <code>string</code> as either a <code>Dictionary&lt;string, object&gt;</code> or as a <code>List&lt;object&gt;</code> depending on the syntax of the JSON <code>string</code>.</p>
<pre><code class="lang-csharp">// The json to be deserialize
var basicJson = &quot;{\&quot;One\&quot;:\&quot;One\&quot;,\&quot;Two\&quot;:\&quot;Two\&quot;,\&quot;Three\&quot;:\&quot;Three\&quot;}&quot;;
// Deserializes the specified json into Dictionary&lt;string, object&gt;.
var data = Json.Deserialize(basicJson);
</code></pre><h4 id="example-6-deserialize-a-generic-type-t">Example 6: Deserialize a generic type <code>&lt;T&gt;</code></h4>
<p>Deserializes the specified JSON <code>string</code> and converts it to the specified object type. Non-public constructors and property setters are ignored.</p>
<pre><code class="lang-csharp">// The json Type BasicJson to be deserialize
var basicJson = &quot;{\&quot;One\&quot;:\&quot;One\&quot;,\&quot;Two\&quot;:\&quot;Two\&quot;,\&quot;Three\&quot;:\&quot;Three\&quot;}&quot;;
// Deserializes the specified string in a new instance of the type BasicJson.
var data = Json.Deserialize&lt;BasicJson&gt;(basicJson);
</code></pre><h3 id="the-csvwriter-class">The <code>CsvWriter</code> class</h3>
<p>Many projects require the use of CSV files to export and import data. With <code>CsvWriter</code> you can easily write objects and data to CSV format. It also provides a useful way to save data into a file.</p>
<p><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Formatters.CsvWriter.html">CsvWriter API Doc</a></p>
<h4 id="example-1-writing-a-list-of-objects">Example 1: Writing a List of objects</h4>
<p>This is the way to write a list of objects into a CSV format.</p>
<pre><code class="lang-csharp"> // The list of objects to be written as CSV
var basicObj = new List&lt;BasicJson&gt;();

using (var stream = new MemoryStream(Encoding.ASCII.GetBytes(basicObj.ToString())))
{               
    // The CSV writer
    var reader = new CsvWriter(stream);
};
</code></pre><h4 id="example-2-writing-a-list-of-objects-into-a-file">Example 2: Writing a List of objects into a file</h4>
<p>You also can write the object into a file or a temporal file.</p>
<pre><code class="lang-csharp">// The list of objects to be written as CSV
var basicObj = new List&lt;BasicJson&gt;();
// This is where the object is save into a file
CsvWriter.SaveRecords(basicObj, &quot;C:/Users/user/Documents/CsvFile&quot;);
</code></pre><h3 id="the-csvreader-class">The <code>CsvReader</code> class</h3>
<p>When you need to parse data in CSV files you&#39;ll always need an easy way to read and load their contents into lists and classes that are usable by your application. Swan provides the <code>CsvReader</code> class to read and load CSV files into objects.</p>
<p><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Formatters.CsvReader.html">CsvReader API Doc</a></p>
<h4 id="example-1-reading-a-csv-data-string">Example 1: Reading a CSV data string</h4>
<p>This is a way to read CSV formatted string.</p>
<pre><code class="lang-csharp"> // The data to be read
var data = @&quot;Company,OpenPositions,MainTechnology,Revenue
            Co,2,&quot;&quot;C#, MySQL, JavaScript, HTML5 and CSS3&quot;&quot;,500 
            Ca,2,&quot;&quot;C#, MySQL, JavaScript, HTML5 and CSS3&quot;&quot;,600&quot;;

using (var stream = new MemoryStream(Encoding.UTF8.GetBytes(data)))
{               
    // The CSV reader
    var reader = new CsvReader(stream, true, Encoding.UTF8);
};
</code></pre><h4 id="example-2-reading-a-csv-file">Example 2: Reading a CSV file</h4>
<p>From a CSV file, you can read and load the information into a generic list.</p>
<pre><code class="lang-csharp">// The list of object to be written as CSV
var basicObj = new List&lt;BasicJson&gt;();
// This is where the object is save into a file
CsvWriter.SaveRecords(basicObj, &quot;C:/Users/user/Documents/CsvFile&quot;);
// This is how you can load the records of the CSV file
var loadedRecords = CsvReader.LoadRecords&lt;BasicJson&gt;(&quot;C:/Users/user/Documents/CsvFile&quot;);
</code></pre><h3 id="the-jsonclient-class">The <code>JsonClient</code> class</h3>
<p>Represents a wrapper <code>HttpClient</code> with extended methods to use with JSON payloads and bearer tokens authentication.</p>
<p><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Networking.JsonClient.html">JsonClient API Doc</a></p>
<h4 id="example-1-authentication">Example 1: Authentication</h4>
<p>You can add Authentication to your requests easily.</p>
<pre><code class="lang-csharp">// The Authenticate
var data = JsonClient.Authenticate(&quot;https://mywebsite.com/api/token&quot;, &quot;admin&quot;, &quot;password&quot;);
</code></pre><h4 id="example-2-an-http-get-request">Example 2: An HTTP GET request</h4>
<p>An easy way to HTTP GET using <code>JsonClient</code>.</p>
<pre><code class="lang-csharp">// The GET
var data = JsonClient.Get&lt;BasicJson&gt;(&quot;https://mywebsite.com/api/data&quot;);
</code></pre><h4 id="example-3-an-http-post-request">Example 3: An HTTP POST request</h4>
<p>An easy way to HTTP POST using <code>JsonClient</code>.</p>
<pre><code class="lang-csharp">// The POST
var data = JsonClient.Post&lt;BasicJson&gt;(&quot;https://mywebsite.com/api/data&quot;, new { filter = true });
</code></pre><h4 id="example-4-making-a-put">Example 4: Making a PUT</h4>
<p>An easy way to HTTP PUT using <code>JsonClient</code>.</p>
<pre><code class="lang-csharp">// The PUT
var data = JsonClient.Put&lt;BasicJson&gt;(&quot;https://mywebsite.com/api/data&quot;, new { filter = true });
</code></pre><h3 id="the-smtpclient-class">The <code>SmtpClient</code> class</h3>
<p>It&#39;s a basic SMTP client that can submit messages to an SMTP server. It&#39;s very easy to configure and it provides a very handy way to make send email messages in your application.</p>
<p><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Networking.SmtpClient.html">SmtpClient API Doc</a></p>
<h4 id="example-1-using-systemnetmailmailmessage">Example 1: Using <code>System.Net.Mail.MailMessage</code></h4>
<p><code>SmtpClient</code> uses the classic  <code>System.Net.Mail.MailMessage</code> provided by .NET to send emails asynchronously.</p>
<pre><code class="lang-csharp">// Create a new smtp client using google&#39;s smtp server
var client = new SmtpClient(&quot;smtp.gmail.com&quot;, 587);

// Send an email 
client.SendMailAsync(new MailMessage(&quot;sender@test.com&quot;, &quot;recipient@test.cm&quot;, &quot;Subject&quot;, &quot;Body&quot;));
</code></pre><h4 id="example-2-using-a-smtp-session-state">Example 2: Using a SMTP session state</h4>
<pre><code class="lang-csharp">// Create a new session state with a sender address
var session = new SmtpSessionState {SenderAddress = &quot;sender@test.com&quot;};

// Add a recipient
session.Recipients.Add(&quot;recipient@test.cm&quot;);

// Send
client.SendMailAsync(session);
</code></pre><h4 id="example-3-adding-an-attachment-with-smtp-session-state">Example 3: Adding an attachment with SMTP session state</h4>
<p>When using <code>SmtpSessionState</code> you have to deal with raw data manipulation, in order to parse MIME attachments <a href="https://www.nuget.org/packages/MimeKit/">MimeKit</a> is recommended.</p>
<pre><code class="lang-csharp">// Create a new session state with a sender address
var session = new SmtpSessionState { SenderAddress = &quot;sender@test.com&quot; };

// Add a recipient
session.Recipients.Add(&quot;recipient@test.cm&quot;);

// load a file as an attachment
var attachment = new MimePart(&quot;image&quot;, &quot;gif&quot;)
{
    Content = new MimeContent(File.OpenRead(&quot;meme.gif&quot;), ContentEncoding.Default),
    ContentDisposition = new ContentDisposition(ContentDisposition.Attachment),
    ContentTransferEncoding = ContentEncoding.Base64,
    FileName = Path.GetFileName(&quot;meme.gif&quot;)
};


using (var memory = new MemoryStream())
{
    //Decode the attachment content
    attachment.Content.DecodeTo(memory);

    //Convert it into a byte array and add it to the session DataBuffer
    session.DataBuffer.AddRange(memory.ToArray());
}

// Send
client.SendMailAsync(session);
</code></pre><h3 id="the-objectmapper-component">The <code>ObjectMapper</code> component</h3>
<p>The <code>ObjectMapper</code> is a component to translate and copy property data from one type to another. You can access a default instance of <code>ObjectMapper</code> through the <code>Runtime</code> class.</p>
<p><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Components.ObjectMapper.html">ObjectMapper API Doc</a></p>
<h4 id="example-1-mapping-with-default-map">Example 1: Mapping with default map</h4>
<p>The conversion generates a map automatically between the properties in the base of the properties names.</p>
<pre><code class="lang-csharp">// Here is mapping the specific user to a destination
var destination = Runtime.ObjectMapper.Map&lt;UserDto&gt;(user);
</code></pre><h4 id="example-2-mapping-with-a-custom-map">Example 2: Mapping with a custom map</h4>
<p>With <code>CreateMap</code> you generate a new map and you can map one custom property with <code>MapProperty</code>.</p>
<pre><code class="lang-csharp">// Creating an Object Mapper
var mapper = new ObjectMapper();
// Creating the map and mapping the property
mapper.CreateMap&lt;User, UserDto&gt;().MapProperty(d =&gt; d.Role, s =&gt; s.Role.Name);
// Then you map the custom map to a destination
var destination = mapper.Map&lt;UserDto&gt;(user);            
</code></pre><h4 id="example-3-removing-a-property-from-the-map">Example 3: Removing a property from the map</h4>
<p>To remove a custom property, you also use <code>CreateMap</code> and then remove the custom property of the mapping.</p>
<pre><code class="lang-csharp">// Create an Object Mapper
var mapper = new ObjectMapper();
// Creating a map and removing a property
mapper.CreateMap&lt;User, UserDto&gt;().RemoveMapProperty(t =&gt; t.Name);
// Then you map the custom map to a destination
var destination = mapper.Map&lt;UserDto&gt;(user);
</code></pre><h3 id="the-network-component">The <code>Network</code> component</h3>
<p>When you are working with projects related to network or you want to extend your application to use some network functionality the Swan&#39;s <code>Network</code> provides miscellaneous network utilities such as a Public IP finder, a DNS client to query DNS records of any kind, and an NTP client.</p>
<p><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Network.html">Network API Doc</a></p>
<h4 id="example-1-ipv4-and-adapters-information">Example 1: IPv4 and adapters information</h4>
<p>It&#39;s always useful to have a tool that gives you access to your adapters information and your IP address local and public and use it in your application.</p>
<pre><code class="lang-csharp">// Gets the active IPv4 interfaces.
var interfaces = Network.GetIPv4Interfaces();

// Retrieves the local IP addresses.
var address = Network.GetIPv4Addresses();

// Gets the public IP address using ipify.org.
var publicAddress = Network.GetPublicIPAddress();
</code></pre><h4 id="example-2-dns-and-ntp">Example 2: DNS and NTP</h4>
<p>Also, you can use the <code>Network</code> utility to access the IPs of the DNS servers and the UTC from the NTP servers.</p>
<pre><code class="lang-csharp">// Gets the configured IPv4 DNS servers for the active network interfaces.
var dnsServers = Network.GetIPv4DnsServers();

// Gets the DNS host entry (a list of IP addresses) for the domain name.
var dnsAddresses = Network.GetDnsHostEntry(&quot;google-public-dns-a.google.com&quot;);

// Gets the reverse lookup FQDN of the given IP Address.
var dnsPointer = Network.GetDnsPointerEntry(IPAddress.Parse(&quot;8.8.8.8&quot;));

// Queries the DNS server for the specified record type.
var mxRecord = Network.QueryDns(&quot;google-public-dns-a.google.com&quot;, DnsRecordType.MX);

// Gets the UTC time by querying from an NTP server
var dateTime = Network.GetNetworkTimeUtc();
</code></pre><h3 id="the-objectcomparer-component">The <code>ObjectComparer</code> component</h3>
<p>Many times, you need to compare the values inside of an object, array, struct or enum, to do so you need to implement your own code or iterate to find if the values are equals. With <code>ObjectComparer</code> you easily compare the properties. It represents a quick object comparer using the public properties of an object or the public members in a structure.</p>
<p><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Components.ObjectComparer.html">ObjectComparer API Doc</a></p>
<pre><code class="lang-csharp">// Compare if two variables of the same type are equal.
ObjectComparer.AreEqual(first, second)

// Compare if two objects of the same type are equal. 
ObjectComparer.AreObjectsEqual(first, second);

// Compare if two structures of the same type are equal.
ObjectComparer.AreStructsEqual(first, second)

// Compare if two enumerables are equal.
ObjectComparer.AreEnumsEqual(first, second)
</code></pre><h3 id="the-objectvalidator-component">The <code>ObjectValidator</code> component</h3>
<p>A simple object validator that allows you to set custom validations and identify if an object satisfies them.</p>
<p><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Components.ObjectValidator.html">ObjectValidator API Doc</a></p>
<p><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Components.ObjectValidationResult.html">ObjectValdiationResult API Doc</a></p>
<h3 id="example-1-simple-object-validation">Example 1: Simple object validation</h3>
<p>Our <code>Simple</code> class to validate</p>
<pre><code class="lang-csharp">  public class Simple
    {
        public string Name { get; set; }
    }
</code></pre><pre><code class="lang-csharp">// create an instance of ObjectValidator
var obj = new ObjectValidator();

// Add a validation to the &#39;Simple&#39; class with a custom error message
obj.AddValidator&lt;Simple&gt;(x =&gt; !string.IsNullOrEmpty(x.Name), &quot;Name must not be empty&quot;);

// validate and return a boolean
var res = obj.IsValid(new Simple { Name = &quot;Name&quot; });
</code></pre><h3 id="example-2-using-attributes">Example 2: Using Attributes</h3>
<p>Both <code>IsValid</code> and <code>Validate</code> methods verify that the object satisfies all custom validators and/or attributes, but instead of just returning a boolean, <code>Validate</code> returns a <code>ObjectValidatorResult</code> which includes all the errors with their properties.</p>
<p>Our <code>Simple</code> class to validate</p>
<pre><code class="lang-csharp">  public class Simple
    {
        [NotNull]
        public string Name { get; set; }

        [Range(1, 10)]
        public int Number { get; set; }

        [Email]
        public string Email { get; set; }
    }
</code></pre><p>This time we&#39;ll be using both custom validators and attributes </p>
<pre><code class="lang-csharp">// using the Runtime&#39;s ObjectValidator singleton
Runtime.ObjectValidator.AddValidator&lt;Simple&gt;(x =&gt; !x.Name.Equals(&quot;Name&quot;), &quot;Name must not be &#39;Name&#39;&quot;);

var res =  Runtime.ObjectValidator.Validate(new Simple{ Name = &quot;name&quot;, Number = 5, Email =&quot;email@mail.com&quot;})
</code></pre><h3 id="example-3-using-the-extension-method">Example 3: Using the extension method</h3>
<p>In this example, we&#39;ll use the previous <code>Sample</code> class to validate an object using the built-in extension method which in turn uses the <code>Runtime</code>&#39;s <code>ObjectValidator</code> singleton to validate our object.</p>
<pre><code class="lang-csharp">// using the Runtime&#39;s ObjectValidator singleton
Runtime.ObjectValidator.AddValidator&lt;Simple&gt;(x =&gt; !x.Name.Equals(&quot;Name&quot;), &quot;Name must not be &#39;Name&#39;&quot;);

// using the extension method
var res = new Simple{ Name = &quot;name&quot;, Number = 5, Email =&quot;email@mail.com&quot;}.IsValid();
</code></pre><h3 id="the-dependencycontainer-component">The <code>DependencyContainer</code> component</h3>
<p>It&#39;s an easy to use IoC Inversion of Control Container of your classes and interfaces, you can register and associate your class with the interface that is going to use and then when you finish working with that you can unregister them. You can access a singleton instance of <code>DependencyContainer</code> called <code>Current</code> by <code>DependencyContainer</code> class.</p>
<p><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Components.DependencyContainer.html">DependencyContainer API Doc</a></p>
<h4 id="example-1-basic-example">Example 1: Basic Example</h4>
<pre><code class="lang-csharp">// Initialize a new instance of DependencyContainer
var container = new DependencyContainer();

// Creates/replaces a named container class registration with a given implementation and default options. 
container.Register&lt;IAnimal, Cat&gt;();

// Attempts to resolve a type using specified options.
var resolve = container.Resolve&lt;IAnimal&gt;();

// Remove a named container class registration.
container.Unregister&lt;IAnimal&gt;();            
</code></pre><h4 id="example-2-using-the-dependencycontainer-current-singleton">Example 2: Using the DependencyContainer <code>Current</code> singleton</h4>
<pre><code class="lang-csharp">// Creates/replaces a named container class registration with a given implementation and default options. 
DependencyContainer.Current.Register&lt;IAnimal, Dog&gt;();

// Attempts to resolve a type using specified options.
var resolve = DependencyContainer.Current.Resolve&lt;IAnimal&gt;();

// Remove a named container class registration.
DependencyContainer.Current.Unregister&lt;IAnimal&gt;();    
</code></pre><h4 id="example-3-canresolve">Example 3: <code>CanResolve</code></h4>
<p>A very handy method to determine if a type can be resolved.</p>
<pre><code class="lang-csharp">// Using CanResolve to check if type can be resolve
if (Runtime.Container.CanResolve&lt;IAnimal&gt;())
{
    // Attempts to resolve a type using specified options.
    Runtime.Container.Resolve&lt;IAnimal&gt;();
}
</code></pre><h3 id="the-messagehub-component">The <code>MessageHub</code> component</h3>
<p>A simple <a href="https://en.wikipedia.org/wiki/Publish%E2%80%93subscribe_pattern">Publisher-Subscriber pattern</a> implementation. It&#39;s a good alternative when your application requires independent, long-running processes to communicate with each other without the need for events which can make code difficult to write and maintain. </p>
<p><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Components.IMessageHub.html">MessageHub API Doc</a></p>
<p>In many scenarios you need a way to know when something happens to an object, there are usually two ways of achieving this: constantly checking the object&#39;s properties or using the pub-sub pattern. To avoid any problems caused by the former method like a possible modification of the object&#39;s properties it is a good practice to use the latter. With the pub-sub pattern, any object can &quot;subscribe&quot; to the publisher&#39;s publish event. When a message is &quot;published&quot; the event is triggered and the custom content of the message is sent. Neither the publisher nor the subscriber knows the existence of one another, therefore the publisher does not directly notify its subscribers, instead there is another component called MessageHub which is known by both(subscriber and publisher) and that filters all incoming messages and distributes them accordingly.</p>
<h4 id="example-1-subscribing-to-a-messagehub">Example 1: Subscribing to a MessageHub</h4>
<p>A simple example using the DependencyContainer discussed above. Keep in mind that in this example both the subscription and the message sending are done in the same place but this is only for explanatory purposes.</p>
<pre><code class="lang-csharp">// use DependencyContainer to create an instance of MessageHub
 var messageHub = DependencyContainer.Current.Resolve&lt;IMessageHub&gt;() as MessageHub;

 // create an instance of the publisher class which has a string as its content
 var message = new MessageHubGenericMessage&lt;string&gt;(this, &quot;SWAN&quot;);

 // subscribe to the publisher&#39;s event and just print its content which is a string 
 // a token is returned which can be used to unsubscribe later on
 var token = messageHub.Subscribe&lt;MessageHubGenericMessage&lt;string&gt;&gt;(m =&gt; m.Content.Info());

 //publish a message and SWAN should be printed on the console
 messageHub.Publish(message);

 // unsuscribe, we will no longer receive any messages 
 messageHub.Unsubscribe&lt;MessageHubGenericMessage&lt;string&gt;&gt;(token);
</code></pre><h3 id="the-ldapconnection-class">The <code>LDAPConnection</code> class</h3>
<p>The <strong>Lightweight Directory Access Protocol</strong> or LDAP is a network protocol for querying and modifying items in directory service providers like <a href="https://en.wikipedia.org/wiki/Active_Directory">Active Directory</a> which provide a systematic set of records organized in a hierarchical structure. Active Directory stores information about users, computers, groups and other objects that are part of a <code>domain</code>.</p>
<p><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Networking.Ldap.LdapConnection.html">LdapConnection API Doc</a></p>
<h4 id="operations">Operations</h4>
<p>LDAP has a couple of operations that can be executed</p>
<ul>
<li><strong>Bind</strong>: binds the current connection to a set of  credentials</li>
<li><strong>Unbind or Disconnect</strong>: signals the server that the connection is about to close then the server proceeds to close the connection to the client</li>
<li><strong>Modify</strong>: this operation is used by LDAP clients to request a change to be performed to the already existing database. This operation is used in combination with one of following :<ul>
<li><strong>Add</strong>: inserts a new entry into the directory </li>
<li><strong>Delete</strong>: deletes an entry from the directory<ul>
<li><strong>Replace</strong>: modifies an existing property value</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="example-1-connecting-to-a-ldap-server">Example 1: Connecting to a LDAP Server</h4>
<p>A connection to a LDAP server is a two-step process, first we <code>connect</code> to a server but that connection is unauthenticated so we need to bind it to a set of credentials. The reason for breaking down the connection process into a two-step action allows us to reset the authorization state using the same connection. </p>
<pre><code class="lang-csharp"> // Create a  LdapConnection variable
 var connection = new LdapConnection();

 // Connect to a server with a deafult port 
 await connection.Connect(&quot;ldap.forumsys.com&quot;, 389);

 // Set up the credentials 
 await connection.Bind(&quot;cn=read-only-admin,dc=example,dc=com&quot;, &quot;password&quot;);
</code></pre><h4 id="example-2-reading-all-the-properties-of-an-entry">Example 2: Reading all the properties of an entry</h4>
<p>After establishing a connection you can use the connection&#39;s Read method to retrieve all properties of an entry</p>
<pre><code class="lang-csharp">// Get all properties of &#39;tesla&#39;
 var properties = await connection.Read(&quot;uid=tesla,dc=example,dc=com&quot;);

 // After getting all properties from an entry select its email and print it
 properties.GetAttribute(&quot;mail&quot;).StringValue.Info();
</code></pre><h4 id="example-3-searching-entries">Example 3: Searching entries</h4>
<p> There are three scopes for searching entries :</p>
<ol>
<li><strong>ScopeBase</strong>: searches only at the base dn</li>
<li><strong>ScopeOne</strong>: searches all entries one level under the specified dn</li>
<li><strong>ScopeSub</strong>: as mentioned above this allows to search entries at all levels</li>
</ol>
<pre><code class="lang-csharp">// Retrieve all entries that have the specified email using ScopeSub 
// which searches all entries at all levels under and including the specified base DN
var searchResult = await connection.Search(&quot;dc=example,dc=com&quot;,LdapConnection.ScopeSub,&quot;(cn=Isaac Newton)&quot;);

// If there are more entries remaining
  while (searchResult.HasMore())
  {
      // Point to the next entry
      var entry = searchResult.Next();

      // Get all attributes 
      var entryAttributes = entry.GetAttributeSet();

      // Select its email and print it
      entryAttributes.GetAttribute(&quot;cn&quot;).StringValue.Info();
  }
</code></pre><h4 id="example-4-modifying-an-entry-attribute">Example 4: Modifying an entry attribute</h4>
<p>An easy way to deal with attributes modification is by calling the Modify method with a <code>LdapModificationOp</code> such as:</p>
<ul>
<li><strong>Replace</strong>: overrides an attribute value. <ul>
<li>If the attribute does not exist it creates a new one</li>
<li>If no value is passed the entire attribute is deleted</li>
</ul>
</li>
<li><strong>Delete</strong> : deletes a value from an attribute.<ul>
<li>If no values are listed or if all of them are the entire attribute is removed</li>
</ul>
</li>
<li><p><strong>Add</strong>: adds a new value to an attribute </p>
<ul>
<li><p>If the attribute does not exist a new one is created</p>
<pre><code class="lang-csharp">// Modify Tesla and sets its email as tesla@email.com
connection.Modify(&quot;uid=tesla,dc=example,dc=com&quot;, 
new[] { new LdapModification(LdapModificationOp.Replace, &quot;mail&quot;, &quot;tesla@email.com&quot;) });

// Deletes the listed values from the given attribute
connection.Modify(&quot;uid=tesla,dc=example,dc=com&quot;, 
new[] { new LdapModification(LdapModificationOp.Delete, &quot;mail&quot;, &quot;tesla@email.com&quot;) });
</code></pre></li>
</ul>
<p>// Add back the recently deleted property
connection.Modify(&quot;uid=tesla,dc=example,dc=com&quot;, 
  new[] { new LdapModification(LdapModificationOp.Add, &quot;mail&quot;, &quot;tesla@email.com&quot;) });</p>
</li>
</ul>
<p> // disconnect from the LDAP server
 connection.Disconnect();</p>
<pre><code>### The `ProcessRunner` class
A class that provides methods that helps us create external processes and capture their output. 

[ProcessRunner API Doc](https://unosquare.github.io/swan/api/Unosquare.Swan.Components.ProcessRunner.html)

#### Example 1: Running a process async
`RunProcessAsync` runs an external process asynchronously and returns the exit code. It provides error and success callbacks to capture binary data from the output and error stream.

```csharp
// executes a process and returns the exit code
var result = await ProcessRunner.RunProcessAsync(
              // The path of the program to be executed
              &quot;dotnet&quot;,
              //Parameters
              &quot;--help&quot;,
              // A success callback with a reference to the output and the process itself
              (data, proc) =&gt;
              {
              // If it executes correctly, print the output
                Encoding.GetEncoding(0).GetString(data).WriteLine();
              },
              // An error callback with a reference to the error and the process itself
              (data, proc) =&gt;
              {
              // If an error ocurred, print out the error
                  Encoding.GetEncoding(0).GetString(data).WriteLine();
              }
             );
</code></pre><h4 id="example-2-getting-a-process-output">Example 2: Getting a process output</h4>
<p>If you are more concern about the output than the process itself, you can use <code>GetProcessOutputAsync</code> to get just a string containing either the output or the error text.</p>
<pre><code class="lang-csharp">// Execute a process asynchronously and return either the ouput or the error
var data = await ProcessRunner.GetProcessOutputAsync(&quot;dotnet&quot;, &quot;--help&quot;);

// Print the result
data.WriteLine();
</code></pre><h4 id="example-3-getting-a-process-result">Example 3: Getting a process result</h4>
<p>If you don&#39;t want to deal with callbacks but you need more information after running an external process, you can use <code>GetProcessResultAsync</code> to get not just the output and error texts but also the exit code.</p>
<pre><code class="lang-csharp">// Execute a process asynchronously and returns a ProcessResult object
var data = await ProcessRunner.GetProcessResultAsync(&quot;dotnet&quot;, &quot;--help&quot;);

// Print out the exit code
$&quot;{data.ExitCode}&quot;.WriteLine();

// The output
data.StandardOutput.WriteLine();

// And the error
data.StandardError.WriteLine();
</code></pre><p><em>Keep in mind that both <code>GetProcessOutputAsync</code> and <code>GetProcessResultAsync</code> are meant to be used for programs that output a relatively small amount of text</em></p>
<h3 id="the-appworkerbase-class">The <code>AppWorkerBase</code> class</h3>
<p>An implementation of the <code>IWorker</code> interface that creates an application service capable of performing some background processing.</p>
<p><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Abstractions.AppWorkerBase.html">AppWorkerBase API Doc</a></p>
<h4 id="example-1-inherit-from-appworkerbase">Example 1: Inherit from AppWorkerBase</h4>
<p>The <code>AppWorkerBase</code> class has many methods that can be overwritten such as:</p>
<ul>
<li><strong>OnWorkerThreadLoopException</strong>: which is called when an unhandled exception is thrown</li>
<li><strong>OnWorkerThreadExit</strong>: executed when the user loop has exited</li>
<li><strong>WorkerThreadLoop</strong>: a custom async loop that checks whether a cancellation has been requested if so it exits the loop</li>
</ul>
<pre><code class="lang-csharp"> class Worker : AppWorkerBase
    {
        // An action that will be executed if the worker is stopped
        public Action OnExit { get; set; }

        // override the base loop method, this is the code will
        // execute until the cancellation token is canceled.
         protected override Task WorkerThreadLoop()
         {
             // delay a second and then proceed
             await Task.Delay(TimeSpan.FromMilliseconds(1000), CancellationToken);

             // just print out this
             $&quot;Working...&quot;.WriteLine();
         }

        // Once the worker is stopped this code will be executed
        protected override void OnWorkerThreadExit()
        {          
            // Execute the base method
            base.OnWorkerThreadExit();

            // Then if the OnExit Action is not null execute it
            OnExit?.Invoke();
        }
    }
</code></pre><h4 id="example-2-using-an-appworker">Example 2: Using an AppWorker</h4>
<p>In this example we use the worker class described above</p>
<pre><code class="lang-csharp">// Create a new AppWorker using the class explained above
var worker = new Worker();

// Setting an OnExit Action that just prints &#39;Exited&#39;
worker.OnExit = () =&gt;
    {
        $&quot;Exited&quot;.WriteLine();
    };

// Start the worker
worker.Start();

// Wait 2 seconds in order to see some output
Task.Delay(2000).Wait();

// Stop the worker         
worker.Stop();
</code></pre><h3 id="the-argumentparser-component">The <code>ArgumentParser</code> component</h3>
<p>This component allows us to parse command line arguments and reconstruct those values into an object, making them much easier to manipulate.</p>
<p><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Components.ArgumentParser.html">ArgumentParser API Doc</a></p>
<h4 id="example-1-using-basic-options">Example 1: Using basic options</h4>
<p>In order to parse arguments first, we need to create a class which the arguments will be parsed into using the <code>ArgumentOption</code> attribute.</p>
<p>In order to set an <code>ArgumentOption</code>, we need to supply at least a short name, a long name or both</p>
<pre><code class="lang-csharp">  internal class Options
    {
        // This attribute maps a command line option to a property 
        // with &#39;v&#39; as its short name and &#39;verbose&#39; as its long name
        [ArgumentOption(&#39;v&#39;, &quot;verbose&quot;, HelpText = &quot;Set verbose mode.&quot;)]
        public bool Verbose { get; set; }

        [ArgumentOption(&#39;u&#39;, Required = true, HelpText = &quot;Set user name.&quot;)]
        public string Username { get; set; }
    }
</code></pre><p>When a program is executed using a command line shell, the OS usually allows passing additional information provided along the program name. For instance <code>example.exe -u user</code> will execute <code>example.exe</code> and the additional text will be passed to it, making the additional arguments accessible to the program using the <code>args</code> parameter in the <em>Main</em> method.</p>
<pre><code class="lang-csharp">// the variable args contains all the additional information(arguments)
// that were passed during the execution
static void Main(string[] args)
  {
    // create a new instance of the class that we want to parse the arguments into
    var options = new Options();

    // if everything went out fine the ParseArguments method will return true
    Runtime.ArgumentParser.ParseArguments(args, options);

  }
</code></pre><h4 id="example-2-using-an-array">Example 2: Using an Array</h4>
<p>In here the complete argument string will be split into an array using the separator provided.</p>
<pre><code class="lang-csharp">internal class Options
  {   
      [ArgumentOption(&#39;n&#39;, &quot;names&quot;, Separator=&#39;,&#39;, 
      Required = true, HelpText = &quot;A list of names separated by a comma&quot;)]
      public string Names[] { get; set; }
  }
</code></pre><h4 id="example-3-using-an-enum">Example 3: Using an Enum</h4>
<p>This maps the argument <code>--color</code> to an <code>Enum</code> which accepts any of the colors defined in <code>ConsoleColor</code> and sets <code>Red</code> as the default value.</p>
<pre><code class="lang-csharp">internal class Options
  {        
      [ArgumentOption(&quot;color&quot;, DefaultValue = ConsoleColor.Red, HelpText = &quot;Set a color.&quot;)]
      public ConsoleColor Color { get; set; }
  }
</code></pre><h3 id="the-settingsprovider-abstraction">The <code>SettingsProvider</code> abstraction</h3>
<p>It represents a provider that helps you save and load settings using plain JSON file.</p>
<p><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Abstractions.SettingsProvider-1.html">SettingsProvider API Doc</a></p>
<h4 id="example-1-loading-and-saving-settings">Example 1: Loading and saving settings</h4>
<p>Here we define a <code>Settings</code> class that contains all the properties we want.</p>
<pre><code class="lang-csharp">internal class Settings 
    {
       public int Port { get; set; } = 9696;

       public string User { get; set; } = &quot;User&quot;;    
    }
</code></pre><p>Once we define our settings we can access them using the <code>Global</code> property inside <code>Instance</code>.</p>
<pre><code class="lang-csharp">//Get user from settings
var user = SettingsProvider&lt;Settings&gt;.Instance.Global.User;

 //Modify the port 
 SettingsProvider&lt;Settings&gt;.Instance.Global.Port = 20;

 //if we want those settings to persist
 SettingsProvider&lt;Settings&gt;.Instance.PersistGlobalSettings();
</code></pre><h3 id="the-connection-class">The <code>Connection</code> class</h3>
<p>It represents a wrapper for TcpClient (a TCP network connection) either on the server or on the client. It provides access to the input and output network streams. It is capable of working in 2 modes.</p>
<p><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Networking.Connection.html">Connection API Doc</a></p>
<p><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Networking.ConnectionListener.html">ConnectionListener API Doc</a></p>
<h4 id="example-1-creating-an-tcp-server">Example 1: Creating an TCP server</h4>
<p>When dealing with a connection on the server side, continuous reading must be enabled, thus deactivating Read methods. If these methods are used an invalid operation exception will be thrown. This example uses a <code>ConnectionListener</code> which is a TCP listener manager with built-in events and asynchronous functionality.</p>
<pre><code class="lang-csharp">// create a new connection listener on a specific port
var connectionListener = new ConnectionListener(1337);

// handle the OnConnectionAccepting event
connectionListener.OnConnectionAccepted += (s, e) =&gt;
{
// create a new connection with a blocksize of 6
    using (var con = new Connection(e.Client,6))
    {
      // an event which will be raised when data is received
        con.DataReceived += (o, y) =&gt;
        {
            var response = Encoding.UTF8.GetChars(y.Buffer);
        };

      con.WriteLineAsync(&quot;world!&quot;).Wait();
    }                
};
connectionListener.Start();
</code></pre><h4 id="example-2-creating-an-tcp-client">Example 2: Creating an TCP client</h4>
<p>Continuous  reading is usually used on the server side so, you may want to disable them on the client side.</p>
<pre><code class="lang-csharp">// create a new TcpCLient object
var client = new TcpClient();

// connect to a specific address and port
client.Connect(&quot;localhost&quot;,1337);

//create a new connection with specific encoding, new line sequence and continous reading disabled
using (var cn = new Connection(client, Encoding.UTF8, &quot;\r\n&quot;, true, 0))
{
     await cn.WriteDataAsync(Encoding.UTF8.GetBytes(&quot;Hello &quot;), true);
     var response = await cn.ReadTextAsync();
}
</code></pre><h3 id="the-benchmark-component">The <code>Benchmark</code> component</h3>
<p>A simple benchmarking class used as an <code>IDisposable</code> that provides useful statistics about a certain piece of code.</p>
<p><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Components.Benchmark.html">Benchmark API Doc</a></p>
<h4 id="example-1-a-simple-benchmark-test">Example 1: A simple benchmark test</h4>
<pre><code class="lang-csharp">//starts a test with a custom name identifier
using (Benchmark.Start(&quot;Test&quot;)) 
{

  // do some logic in here

}

// dump results into a string
var results = Benchmark.Dump();
</code></pre><h3 id="the-delayprovider-component">The <code>DelayProvider</code> component</h3>
<p>A useful component that implements several delay mechanisms.</p>
<p><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Components.DelayProvider.html">DelayProvider API Doc</a></p>
<h4 id="example-1-creating-a-delay">Example 1: Creating a delay</h4>
<pre><code class="lang-csharp">// using the ThreadSleep strategy
using (var delay = new DelayProvider(DelayProvider.DelayStrategy.ThreadSleep))
 {
     // retrieve how much time we delayed
     var time = delay.WaitOne();
 }  
</code></pre><h3 id="the-waiteventfactory-component">The <code>WaitEventFactory</code> component</h3>
<p><code>WaitEventFactory</code> provides a standard <a href="https://docs.microsoft.com/en-us/dotnet/api/system.threading.manualresetevent?view=netframework-4.7.1">ManualResetEvent</a> factory with a unified API. 
<code>ManualResetEvent</code> is a variation of <code>AutoResetEvent</code> that doesn&#39;t automatically reset after a thread is let through on a <code>WaitOne</code> call. Calling <code>Set</code> on a <code>ManualResetEvent</code> serves like an open gate allowing any number of threads that <code>WaitOne</code> pass throughCalling and <code>Reset</code> closes this gate. This type of event is usually used to signal that a certain operation has completed.</p>
<p><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.Components.WaitEventFactory.html">WaitEventFactory API Doc</a></p>
<h4 id="example-1-using-the-waiteventfactory">Example 1: Using the <code>WaitEventFactory</code></h4>
<pre><code class="lang-csharp">// creates a WaitEvent using the slim version of ManualResetEvent
private static readonly IWaitEvent waitEvent = WaitEventFactory.CreateSlim(false);

static void Main()
{
 // start two tasks
    Task.Factory.StartNew(() =&gt;
    {
        Work(1);
    });

    Task.Factory.StartNew(() =&gt;
    {
        Work(2);
    });

    //Send first signal to retrieve data
    waitEvent.Complete();
    waitEvent.Begin();

    Thread.Sleep(TimeSpan.FromSeconds(2));

    // Send second signal
    waitEvent.Complete();

    Console.ReadLine();
}
</code></pre><pre><code class="lang-csharp">static void Work(int taskNumber)
 {
     $&quot;Data retrieved:{taskNumber}&quot;.WriteLine();
     waitEvent.Wait();

     Thread.Sleep(TimeSpan.FromSeconds(2));
     $&quot;All finished up {taskNumber}&quot;.WriteLine();
 }
</code></pre><h3 id="atomic-types">Atomic types</h3>
<p>Atomic operations are indivisible which means that they cannot interrupted partway through. <code>SWAN</code> provides Atomic types which include mechanisms to perform these kinds of operations on Built-In types like: <code>bool</code>, <code>long</code>, and <code>double</code>. This is quite useful in situations where we have to deal with lots of threads performing writes on variables because we can assure that threads will not interrupt each other in the middle of an operation and perform a <code>torn write</code>.</p>
<p><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.AtomicBoolean.html">AtomicBoolean API Doc</a></p>
<p><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.AtomicLong.html">AtomicLong API Doc</a></p>
<p><a href="https://unosquare.github.io/swan/api/Unosquare.Swan.AtomicDouble.html">AtomicDouble API Doc</a></p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="doc" align="center">
              <span class="small mobile-hide">
                <img id="logo" class="doc-logo" src="swan-logo-256.png" alt="">
              </span>
            </div>
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li class="top-sep">
                    <a href="https://github.com/unosquare/swan/blob/master/README.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Copyright © 2017-2019 <a href="https://www.unosquare.com">Unosquare</a></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="styles/docfx.js"></script>
    <script type="text/javascript" src="styles/main.js"></script>
    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-8535255-2', 'auto');
        ga('send', 'pageview');
    </script>
  </body>
</html>
